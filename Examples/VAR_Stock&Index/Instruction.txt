1. Introduction
This program is designed to calculate the Value of Risk and Expected Shortfall of equity using three traditional methods:
a. Historical Method: Use historical equity price change to simulated future equity price, then caculate future P&L, then we have VaR and ES
b. Analytical Method: Assume return of equity follow normal distribution, VaR = mu - alpha*sigma;
c. Monte Carlo Methods: Use Geometric Brownian Motion (GBM) to simulate equity price, then we have VaR and ES

Note: The program is very similar with project of VAR_CurrencyForward, but more simple, the only difference is in VaR.cpp and data sets. See comments in VAR_CurrencyForward for more information.

2. Data Input
See Main.cpp for data input, try SPY Historical Data.csv
Note: you have to caculate stock daily return based on historical stock in Excel first.

3. Result
After running the result, we can see the result. See results from SPY Historical Data.csv as follow. We can see the VaR and Expected Shortfall calculate by three methods are very close. 

OUTPUT:

Calculate VaR by historical method:
Price      Portfolio            P&L
268.20       26820.00         134.00
266.68       26668.00         -18.00
267.67       26767.00          81.00
266.11       26611.00         -75.00
266.86       26686.00           0.00
267.50       26750.00          64.00
266.29       26629.00         -57.00
267.38       26738.00          52.00
266.06       26606.00         -80.00
267.36       26736.00          50.00
266.02       26602.00         -84.00
267.69       26769.00          83.00
266.27       26627.00         -59.00
268.31       26831.00         145.00
268.83       26883.00         197.00
266.62       26662.00         -24.00
266.50       26650.00         -36.00
265.44       26544.00        -142.00
266.84       26684.00          -2.00
266.95       26695.00           9.00
267.01       26701.00          15.00
268.43       26843.00         157.00
266.45       26645.00         -41.00
266.87       26687.00           1.00
267.16       26716.00          30.00
268.22       26822.00         136.00
267.77       26777.00          91.00
268.12       26812.00         126.00
267.79       26779.00          93.00
268.08       26808.00         122.00
266.66       26666.00         -20.00
267.23       26723.00          37.00
268.26       26826.00         140.00
266.65       26665.00         -21.00
267.02       26702.00          16.00
267.16       26716.00          30.00
267.23       26723.00          37.00
266.22       26622.00         -64.00
270.17       27017.00         331.00
265.35       26535.00        -151.00
267.01       26701.00          15.00
266.15       26615.00         -71.00
266.15       26615.00         -71.00
266.42       26642.00         -44.00
267.16       26716.00          30.00
267.69       26769.00          83.00
266.98       26698.00          12.00
265.95       26595.00         -91.00
268.91       26891.00         205.00
266.39       26639.00         -47.00
265.41       26541.00        -145.00
266.60       26660.00         -26.00
263.82       26382.00        -304.00
267.41       26741.00          55.00
266.61       26661.00         -25.00
266.69       26669.00         -17.00
266.62       26662.00         -24.00
268.56       26856.00         170.00
267.08       26708.00          22.00
267.61       26761.00          75.00
266.31       26631.00         -55.00
266.45       26645.00         -41.00
267.01       26701.00          15.00
266.16       26616.00         -70.00
267.52       26752.00          66.00
266.62       26662.00         -24.00
267.00       26700.00          14.00
266.58       26658.00         -28.00
265.83       26583.00        -103.00
265.34       26534.00        -152.00
268.92       26892.00         206.00
266.16       26616.00         -70.00
266.43       26643.00         -43.00
268.76       26876.00         190.00
266.11       26611.00         -75.00
269.44       26944.00         258.00
268.24       26824.00         138.00
266.71       26671.00         -15.00
267.06       26706.00          20.00
266.34       26634.00         -52.00
267.46       26746.00          60.00
266.95       26695.00           9.00
266.57       26657.00         -29.00
267.14       26714.00          28.00
267.80       26780.00          94.00
266.82       26682.00          -4.00
266.64       26664.00         -22.00
267.29       26729.00          43.00
266.37       26637.00         -49.00
266.46       26646.00         -40.00
268.18       26818.00         132.00
266.64       26664.00         -22.00
262.60       26260.00        -426.00
267.81       26781.00          95.00
268.40       26840.00         154.00
268.07       26807.00         121.00
267.39       26739.00          53.00
267.42       26742.00          56.00
268.01       26801.00         115.00
266.81       26681.00          -5.00
266.65       26665.00         -21.00
266.80       26680.00          -6.00
268.78       26878.00         192.00
267.67       26767.00          81.00
266.68       26668.00         -18.00
266.08       26608.00         -78.00
267.31       26731.00          45.00
266.98       26698.00          12.00
266.49       26649.00         -37.00
266.81       26681.00          -5.00
268.05       26805.00         119.00
266.55       26655.00         -31.00
266.39       26639.00         -47.00
265.73       26573.00        -113.00
268.88       26888.00         202.00
265.21       26521.00        -165.00
266.80       26680.00          -6.00
266.75       26675.00         -11.00
267.15       26715.00          29.00
267.02       26702.00          16.00
264.90       26490.00        -196.00
269.02       26902.00         216.00
264.72       26472.00        -214.00
267.31       26731.00          45.00
267.27       26727.00          41.00
267.42       26742.00          56.00
264.64       26464.00        -222.00
268.42       26842.00         156.00
267.12       26712.00          26.00
266.68       26668.00         -18.00
268.68       26868.00         182.00
267.27       26727.00          41.00
268.00       26800.00         114.00
266.83       26683.00          -3.00
266.99       26699.00          13.00
268.19       26819.00         133.00
266.97       26697.00          11.00
266.64       26664.00         -22.00
266.80       26680.00          -6.00
267.46       26746.00          60.00
266.87       26687.00           1.00
266.63       26663.00         -23.00
266.57       26657.00         -29.00
266.72       26672.00         -14.00
267.41       26741.00          55.00
266.98       26698.00          12.00
266.38       26638.00         -48.00
267.31       26731.00          45.00
267.32       26732.00          46.00
266.25       26625.00         -61.00
266.85       26685.00          -1.00
263.37       26337.00        -349.00
267.22       26722.00          36.00
269.28       26928.00         242.00
266.83       26683.00          -3.00
267.29       26729.00          43.00
263.01       26301.00        -385.00
266.48       26648.00         -38.00
267.05       26705.00          19.00
269.40       26940.00         254.00
265.98       26598.00         -88.00
266.29       26629.00         -57.00
267.43       26743.00          57.00
266.87       26687.00           1.00
267.14       26714.00          28.00
268.02       26802.00         116.00
268.34       26834.00         148.00
267.21       26721.00          35.00
265.08       26508.00        -178.00
267.70       26770.00          84.00
266.83       26683.00          -3.00
266.57       26657.00         -29.00
269.49       26949.00         263.00
267.70       26770.00          84.00
266.98       26698.00          12.00
266.78       26678.00          -8.00
265.96       26596.00         -90.00
267.39       26739.00          53.00
267.11       26711.00          25.00
266.95       26695.00           9.00
266.19       26619.00         -67.00
266.91       26691.00           5.00
266.35       26635.00         -51.00
267.01       26701.00          15.00
267.83       26783.00          97.00
267.16       26716.00          30.00
267.74       26774.00          88.00
267.95       26795.00         109.00
267.40       26740.00          54.00
267.16       26716.00          30.00
268.36       26836.00         150.00
266.57       26657.00         -29.00
266.44       26644.00         -42.00
267.53       26753.00          67.00
267.26       26726.00          40.00
266.48       26648.00         -38.00
267.17       26717.00          31.00
267.20       26720.00          34.00
267.04       26704.00          18.00
267.11       26711.00          25.00
266.93       26693.00           7.00
268.18       26818.00         132.00
265.86       26586.00        -100.00
267.31       26731.00          45.00
265.59       26559.00        -127.00
267.19       26719.00          33.00
268.95       26895.00         209.00
265.90       26590.00         -96.00
267.26       26726.00          40.00
267.20       26720.00          34.00
266.96       26696.00          10.00
267.72       26772.00          86.00
267.26       26726.00          40.00
266.68       26668.00         -18.00
267.30       26730.00          44.00
265.92       26592.00         -94.00
266.78       26678.00          -8.00
267.10       26710.00          24.00
266.26       26626.00         -60.00
265.57       26557.00        -129.00
269.04       26904.00         218.00
266.10       26610.00         -76.00
267.30       26730.00          44.00
268.55       26855.00         169.00
266.63       26663.00         -23.00
267.46       26746.00          60.00
266.73       26673.00         -13.00
269.50       26950.00         264.00
266.70       26670.00         -16.00
269.16       26916.00         230.00
266.31       26631.00         -55.00
266.54       26654.00         -32.00
265.91       26591.00         -95.00
266.91       26691.00           5.00
267.69       26769.00          83.00
268.30       26830.00         144.00
267.66       26766.00          80.00
267.33       26733.00          47.00
266.83       26683.00          -3.00
265.77       26577.00        -109.00
267.71       26771.00          85.00
268.55       26855.00         169.00
265.83       26583.00        -103.00
266.72       26672.00         -14.00
267.41       26741.00          55.00
266.79       26679.00          -7.00
266.54       26654.00         -32.00
266.99       26699.00          13.00
267.41       26741.00          55.00
Expected shortfall in 95.00% is -249.27
The one day 95% VaR based on Historical method is: -142.00

calculate VaR by Monte Carlo
Expected shortfall in 95.000000% is -232.278976
The one day 95% VaR based on Monte Carlo with only GBM model is: -185.410640

calculate VaR by analytical method
The one day 95% VaR based on Analytical method is: -168.250469

Press any key to continue . . .
